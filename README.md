# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

### Паттерн проектирования
В данном проекте используется паттерн **MVC** (Model-View-Controller).

-**Model**: отвечает за управление данными приложения, например, классы GoodsManager, BasketManager, и PaymentManager.

-**View**: отвечает за отображение данных и пользовательский интерфейс, например, классы GoodsCard, Modal, и Basket.

-**Controller**: координирует взаимодействие между Model и View. В проекте эту роль выполняют классы App и AppController, которые управляют переходами, обработкой событий и взаимодействием между данными и интерфейсом.

Паттерн MVC обеспечивает модульность и удобство масштабирования проекта, а также разделяет ответственность между слоями, что упрощает тестирование и поддержку кода.


## Классы модели:

**1. Class GoodsManager**
Управляет доступными товарами и взаимодействием с корзиной.

Поля:
- goodsList: Goods[]: массив доступных товаров.

Методы, используемые в классе:
- getAvailableGoods(): возвращает товары, которые ещё не были добавлены в корзину.

**2. Class BasketManager**
Управляет состоянием корзины пользователя, включая товары и общую стоимость.

Поля:
- basketGoods: Goods[]: массив товаров в корзине.
- totalPrice: number: общая стоимость корзины.
- eventListeners: { [key: string]: EventListener }: объект, содержащий обработчики событий для элементов корзины.

Методы, используемые в классе:
- getBasket(): возвращает текущее состояние корзины.
- addToBasket(goods: Goods): добавляет товар в корзину и пересчитывает стоимость.
- removeFromBasket(goodsId: string): удаляет товар из корзины.
- calculateTotalPrice(): подсчитывает общую стоимость.
- getTotalPrice(): возвращает общую стоимость.

**3. Class PaymentManager**
Управляет процессом оформления заказа.

Поля:
- paymentData: Partial<Payment>: данные пользователя для оплаты.

Методы, используемые в классе:
- setPaymentData(data: Partial<Payment>): сохраняет данные оплаты.
- getPaymentData(): возвращает текущие данные.
- resetPaymentData(): сбрасывает данные.
- savePaymentDetails(paymentData: { payment: string; address: string }): сохраняет данные об оплате и адресе.
- saveContactDetails(contactData: { email: string; phone: string }): сохраняет данные юзера.

**4. Class StateManager**
Хранит и управляет текущим состоянием приложения.

Поля:
- availableGoods: Goods[]: доступные товары.
- paymentData: Partial<Payment>: данные оплаты.

Методы, используемые в классе:
- saveState(state: PurchasingProcess): сохраняет текущее состояние.
- restoreState(): возвращает сохранённое состояние.
- resetState(): сбрасывает состояние.

## Классы представления:

**1. Class GoodsCard**
Представляет карточку товара. Отвечает за отображение карточек на главной странице и обработку кликов по ним. Создает карточку на основе переданных данных. Управляет обработчиками событий. 

Поля:
- goods: Goods: объект товара, передаваемый в карточку.
- element: HTMLElement: HTML-элемент карточки.

Методы, используемые в классе:
- constructor(goods: Goods): конструктор принимает объект товара.
- renderCard(): инициализирует HTML-разметку карточки.

**2. Class Modal**
Это базовый класс для всех модальных окон (информация о товаре, корзина, оплата и т. д.). Он отвечает за рендеринг модальных окон и их закрытие. 

Поля:
- title: string: заголовок модального окна.
- content: HTMLElement: контент модального окна.
- modalElement: HTMLElement: HTML-элемент, представляющий модальное окно.
- overlay: HTMLElement: HTML-элемент для затемнения фона при открытом модальном окне.

Методы, используемые в классе:
- constructor(title: string, content: HTMLElement): принимает заголовок модального окна и заполняемые данные.
- renderModal(): инициализирует HTML-разметку модального окна.
Устанавливаем обработчики событий для управления окном(закрытие, открытие следующих).

**3. Class Basket**
Он управляет корзиной товаров. Отвечает за добавление, удаление товаров и подсчет общей стоимости. 

Поля:
- basketGoods: Goods[]: массив объектов товаров, добавленных в корзину.
- totalPrice: number: общая стоимость всех товаров в корзине.
- basketElement: HTMLElement: HTML-элемент для отображения корзины на странице.

Методы, используемые в классе:
- constructor(): инициализирует корзину (массив товаров и общую сумму).
- renderBasket(): рендерит HTML список корзины.

**4. Class ModalManager**
Управляет отображением и состоянием модальных окон.

Поля:
- currentModal: HTMLElement | null: текущий открытый модальный элемент (если окно открыто), иначе null.
- modalState: boolean: флаг, указывающий, открыто ли модальное окно (true — открыто, false — закрыто).
- modalData: any: данные, переданные в модальное окно при его открытии.
- modalContainer: HTMLElement: контейнер, в котором отображаются модальные окна.

Методы, используемые в классе:
- openModal(type: string, data?: any): открывает модальное окно указанного типа с переданными данными.
- closeModal(): закрывает текущее модальное окно.
- isOpen(): проверяет, открыто ли какое-либо модальное окно (true, если открыто; false, если закрыто).

## Классы контроллеров:

**1. Class AppController**
Координирует работу всех остальных классов.

Поля:
- goodsManager: GoodsManager: управление товарами.
- basketManager: BasketManager: управление корзиной.

Методы, используемые в классе:
- init(): запускает приложение.
- handleAddToBasket(goodsId: string): добавляет товар в корзину.
- handleRouteChange(): обрабатывает переходы между разделами.

**2. Class App**
Это основной класс приложения, который объединяет остальные модули. Управляет инициализацией проекта и взаимодействием компонентов. 

Поля:
- stateManager: StateManager: объект для управления состоянием приложения.
- rootElement: HTMLElement: корневой HTML-элемент приложения.

Методы, используемые в классе:
- init(): Запускает приложение (рендеринг карточек, настройка обработчиков).
- handleRouteChange(): Обрабатывает переходы между разделами (корзиной и главным окном).

**3. Class PurchasingProcess**
Управляет процессом оформления заказа. Обрабатывает действия пользователя при переходе между этапами оплаты.

Поля:
- basket: Basket: объект корзины, содержащий товары пользователя.
- currentStep: number: текущий шаг процесса оформления заказа.
- stepElements: HTMLElement[]: массив HTML-элементов, представляющих шаги оформления заказа.
- processContainer: HTMLElement: контейнер, в котором отображается процесс оформления заказа.

Методы, используемые в классе:
- constructor(basket: Basket): Инициализирует процесс на основе текущей корзины.
- renderStep(step: number): Рендерит нужный этап оформления заказа.

## Ключевые интерфейсы и соответствующие им типы данных

1. Goods: Интерфейс для представления главной страницы сайта и отображения всех необходимых данных в карточках.

```
export interface Goods {
  id: string; //id товара
  category: string; //категория товара
  title: string; //название товара
  image: string; //картинка товара
  price: number; //цена
}
```

2. GoodSelect: Интерфейс для представления модального окна и отображения всех необходимых данных на выбранной карточке.

```
export interface GoodSelect {
  id: string; //id товара
  category: string; //категория товара
  title: string; //название товара
  image: string; //картинка товара
  description: string; //описание товара
  price: number; //цена
}
```


3. Basket: Интерфейс отвечающий за отображение корзины с товарами, краткой информацией и них и стоимость, включая общую.

```
export interface Basket {
  basketGoods: Goods[]; //выбранные товары(массив данных)
  priceTotal: number; //общая цена товаров 
}
```

4. Payment: Интерфейс отвечает за прохождение пути оплаты и отображения всех необходимых данных, ключая итоговую стоимость 
отображаемую на последнем шаге

```
export interface Payment {
  basket: Basket; //выбранные товары(используется только массив price[]) 
  payment: string; //тип оплаты
  address: string; //адрес доставки
  email: string; //почта получателя
  phone: string; //номер получателя
}
```

5. PurchasingProcess: Интерфейс сохранения действий пользователя на сайте, и отображение актуальной информации на странице.

```
export interface PurchasingProcess {
  basketGoods: Goods[]; //доступные товары(массив данных)
  basket: Basket; //выбранные товары
}
```

## Размещение в сети
Рабочая версия сайта доступна по адресу: https://eugendes.github.io/web-larek-frontend/